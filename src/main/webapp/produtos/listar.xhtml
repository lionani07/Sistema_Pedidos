<!DOCTYPE html>
<ui:composition template="/WEB-INF/template/template.xhtml"
xmlns="http://www.w3.org/1999/xhtml"
xmlns:f="http://xmlns.jcp.org/jsf/core"
xmlns:h="http://xmlns.jcp.org/jsf/html"
xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
xmlns:p="http://primefaces.org/ui">

<f:metadata>
<f:viewAction action="#{produtoController.listar}" />
</f:metadata>

<ui:define name="corpo">

<h:form id="frm_produtos">

<p:fieldset legend="Listado de Produtos">

<p:dataTable id="datable_produtos" var="produto" value="#{produtoController.listaProdutos}" paginator="true"
rows="15" selectionMode="single" rowKey="#{produto.id}" selection="#{produtoController.productoSelect}" paginatorPosition="bottom" >

<f:facet name="header">
<div align="left">
<p:commandButton icon="ui-icon-circle-plus" value="Novo" action="/produtos/novo?faces-redirect=true"  />
</div>
</f:facet>

<p:column headerText="Código">
<h:outputText value="#{produto.id}" />
</p:column>

<p:column headerText="Nome">
<h:outputText value="#{produto.nome}" />
</p:column>

<p:column headerText="Preço">
<h:outputText value="#{produto.preco}" >
<f:convertNumber pattern="R$ #,##0.00" />
</h:outputText>
</p:column>

<p:column headerText="Preco de Compra">
<h:outputText value="#{produto.precoMaximoCompra}" >
<f:convertNumber pattern="R$ #,##0.00" />
</h:outputText>
</p:column>

<p:column style="width:30px">
<p:button icon="ui-icon-pencil" title="Editar" outcome="/produtos/novo">
<f:param name="id" value="#{produto.id}" />
</p:button>
</p:column>

<p:column style="width:30px">
<p:commandButton icon="ui-icon-trash" title="remove" update=":frm_produtos:datable_produtos" action="#{produtoController.delete}">
<f:setPropertyActionListener value="#{produto}" target="#{produtoController.productoSelect}" />
<p:confirm header="Eliminar Produto" message="Tem Certeza?" icon="ui-icon-alert" />

</p:commandButton>
  <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" >
		<p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
		<p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
  </p:confirmDialog>

</p:column>

</p:dataTable>

</p:fieldset>

</h:form>

</ui:define>
</ui:composition>